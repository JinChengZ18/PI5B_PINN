[2026-01-27 17:18:03][INFO] 日志文件创建于: /data/sda/zjc/comsol_pinn/logs/M04b/exp12/train_20260127_171803_gpu2_pid977562.log
[2026-01-27 17:18:03][INFO] 进程 PID: 977562
[2026-01-27 17:18:03][INFO] ========== PINN 训练开始 ==========
[2026-01-27 17:18:03][INFO] 物理项权重 λ_pde = 1.0
[2026-01-27 17:18:03][INFO] 使用设备: cuda
[2026-01-27 17:18:03][INFO] 训练参数: {'lambda_pde': 1.0, 'epochs': 120, 'lr': 0.005, 'batch_cases': 1, 'use_pde_anneal': True, 'pde_anneal_gamma': 0.1, 'pde_lambda_min': 0.0, 'use_soft_mask': True, 'mask_alpha': 40.0, 'mask_temp_ratio': 0.7, 'points_per_case': 500000, 'device': 'cuda', 'num_workers': 8, 'log_dir': 'logs/M04b/exp12', 'ckpt_dir': 'checkpoints/M04b/exp12'}
[2026-01-27 17:18:03][INFO] 数据集大小: 141 cases
[2026-01-27 17:18:03][INFO] 每 case 采样点数: 500000
[2026-01-27 17:18:05][INFO] 模型结构:
SimplePINN(
  (net): Sequential(
    (0): Linear(in_features=7, out_features=128, bias=True)
    (1): SiLU()
    (2): Linear(in_features=128, out_features=128, bias=True)
    (3): SiLU()
    (4): Linear(in_features=128, out_features=1, bias=True)
  )
)
[2026-01-27 17:18:05][INFO] 优化器: AdamW, 初始 lr=0.005, 调度策略: ReduceLROnPlateau(factor=0.5, patience=10)
[2026-01-27 17:18:27][WARNING] [OOM] Epoch 1, Batch 0: 降低采样点数重试
Traceback (most recent call last):
  File "/data/sda/zjc/comsol_pinn/M04b_pinn/train.py", line 192, in <module>
    main()
  File "/data/sda/zjc/comsol_pinn/M04b_pinn/train.py", line 174, in main
    f"PDE={loss_pde.item():.6f} | "
UnboundLocalError: local variable 'loss_pde' referenced before assignment
